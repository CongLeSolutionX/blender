Referenced by commit 490da48d78a, Selective changes picked from: e01449fa4bb0df252d32a3b98ee1e8f195923d96
